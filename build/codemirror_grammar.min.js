/**
*
*   CodeMirrorGrammar
*   Transform a grammar specification in JSON format,
*   into a CodeMirror syntax-highlight parser mode
*
*   https://github.com/foo123/codemirror-grammar
*
**/(function(){var e="0.1",n=(Array.prototype.slice,Object.prototype.hasOwnProperty),t=Object.prototype.toString,l=function(e){return"number"==typeof e||e instanceof Number},r=function(e){return e&&("string"==typeof e||e instanceof String)&&1==e.length},i=function(e){return e&&("string"==typeof e||e instanceof String)},s=function(e){return e&&("[object RegExp]"==t.call(e)||e instanceof RegExp)},o=function(e){return e&&"[object Array]"==t.call(e)},u=function(e){return e&&"[object Object]"==t.call(e)},a=function(e){return o(e)?e:[e]},d=function(e){if(!u(e)&&!o(e))return e;var t={};for(var l in e)n.call(e,l)&&(t[l]=u(e[l])?d(e[l]):o(e[l])?e[l].slice():e[l]);return t},m=function(e,t){if(!u(t)&&!o(t))return d(e);var l={};for(var r in t)n.call(t,r)&&(l[r]=n.call(e,r)?u(e[r])&&!i(e[r])?m(e[r],t[r]):o(e[r])?e[r].slice():e[r]:d(t[r]));return l},f={RegExpID:null,RegExpGroups:null,style:{error:"error",comment:"comment",meta:"meta",defines:"def",atom:"atom",keyword:"keyword",builtin:"builtin",operator:"operator",identifier:"variable",identifier2:"variable",identifier3:"variable",identifier4:"variable",identifier5:"variable",number:"number",number2:"number",number3:"number",string:"string",string2:"string",string3:"string",block:"string",block2:"string",block3:"string",delimiter:"meta"},comments:{line:null,block:null},blocks:null,blocks2:null,blocks3:null,identifiers:null,identifiers2:null,identifiers3:null,identifiers4:null,identifiers5:null,numbers:null,numbers2:null,numbers3:null,strings:null,strings2:null,strings3:null,operators:{one:null,two:null,words:null},delimiters:{one:null,two:null,three:null},atoms:null,meta:null,defines:null,keywords:null,builtins:null,indent:null},c={RegExpID:null,RegExpGroups:null,style:{error:"error",comment:"comment",meta:"meta",defines:"def",atom:"atom",keyword:"keyword",builtin:"builtin",attribute:"attribute",tag:"tag",tag2:"tag",tag3:"tag",tag4:"tag",tag5:"tag",identifier:"variable",identifier2:"variable",identifier3:"variable",identifier4:"variable",identifier5:"variable",number:"number",number2:"number",number3:"number",string:"string",string2:"string",string3:"string",block:"string",block2:"string",block3:"string",delimiter:"meta"},comments:{line:null,block:null},blocks:null,blocks2:null,blocks3:null,tags:null,tags2:null,tags3:null,tags4:null,tags5:null,autoclose:null,attributes:null,attributes2:null,attributes3:null,identifiers:null,identifiers2:null,identifiers3:null,identifiers4:null,identifiers5:null,numbers:null,numbers2:null,numbers3:null,strings:null,strings2:null,strings3:null,atoms:null,meta:null,defines:null,keywords:null,builtins:null,delimiters:{one:null,two:null,three:null},indent:null},k=1,b=2,p=4,g=8,v=16,y=32,w=64,h=128,T=256,x=512,z=32768,E=131072,_=262144,R=200,G=220,I=300,D=310,L=320,j=/([\-\.\*\+\?\^\$\{\}\(\)\|\[\]\/\\])/g,A=function(e,n){if(!e||l(e))return e;var t=n?n.length:0;return t&&n==e.substr(0,t)?new RegExp("^"+e.substr(t)):e},S=function(e){for(var n=0,t=e.length;t>n;n++)e[n]=e[n].replace(j,"\\$1");return new RegExp("^(("+e.join(")|(")+"))\\b")},U=function(e,n){var t,o;return n=n||0,l(e)?e:r(e)?(t=function(t,l){l=!1!==l;var r=e,i=t.string.charAt(t.pos)||"";return r==i?(l&&(t.pos+=1),{key:n,val:i}):!1},t.__type=I,t):i(e)?(o=e.length,t=function(t,l){l=!1!==l;var r=e,i=t.string.substr(t.pos,o),s=i;return r==s?(l&&(t.pos+=o),{key:n,val:i}):!1},t.__type=D,t):s(e)?(t=function(t,l){l=!1!==l;var r=t.string.slice(t.pos).match(e);return!r||r.index>0?!1:(l&&(t.pos+=r[0].length),{key:n,val:r})},t.__type=L,t):e},M=function(e,n,t){if(t)return[U(S(a(e)))];var l,r,i;for(l=a(e),r=0,i=l.length;i>r;r++)l[r]=U(A(l[r],n),r);return l},O=function(e,n){var t,l,r,i,s,u,d;for(i=[],s=[],t=a(e),o(t[0])||(t=[t]),l=0,r=t.length;r>l;l++)u=U(A(t[l][0],n),l),d=t[l].length>1?U(A(t[l][1],n),l):u,i.push(u),s.push(d);return{start:i,end:s}},F=function(e,n,t){var l,r,i=n.length;for(l=0;i>l;l++)if(r=n[l](e,t))return r;return!1},P=function(e,n,t,l){var r;return r=null==e?function(e,r){return e.skipToEnd(),r.tokenize=l||null,r.lastToken=n,t}:function(r,i){for(var s=!1;!r.eol();){if(e(r)){s=!0;break}r.next()}return s&&(i.tokenize=l||null),i.lastToken=n,t},r.__type=n,r},C=function(e,n,t,l){var r=function(r,i){for(var s,o=!1,u=!1;!r.eol();){if(e(r)&&!o){u=!0;break}s=r.next(),o=!o&&"\\"==s}return(u||!o&&!t)&&(i.tokenize=l||null),i.lastToken=h,n};return r.__type=h,r},N=function(e,n,t){var r=n.DEFAULT,i=t.multiLineStrings,s=e.style,o=e.comments.start||null,u=e.comments.end||null,a=e.blocks.start||null,d=e.blocks.end||null,m=e.blocks2.start||null,f=e.blocks2.end||null,c=e.blocks3.start||null,h=e.blocks3.end||null,G=e.strings.start||null,I=e.strings.end||null,D=e.strings2.start||null,L=e.strings2.end||null,j=e.strings3.start||null,A=e.strings3.end||null,S=e.identifiers,M=e.identifiers2,O=e.identifiers3,N=e.identifiers4,$=e.identifiers5,V=e.numbers,q=e.numbers2,B=e.numbers3,H=e.atoms,J=e.meta,K=e.defines,Q=e.keywords,W=e.builtins,X=e.operators,Y=e.delimiters;e.hasIndent,e.indent;var Z=function(e,n){var t,R,Z;return e.eatSpace()?(n.lastToken=k,r):o&&(R=F(e,o))?(Z=u[R.key],l(Z)&&(Z=R.val[Z]),n.tokenize=P(U(Z),p,s.comment),n.tokenize(e,n)):a&&(R=F(e,a))?(Z=d[R.key],l(Z)&&(Z=R.val[Z]),n.tokenize=P(U(Z),z,s.block),n.tokenize(e,n)):m&&(R=F(e,m))?(Z=f[R.key],l(Z)&&(Z=R.val[Z]),n.tokenize=P(U(Z),z,s.block2),n.tokenize(e,n)):c&&(R=F(e,c))?(Z=h[R.key],l(Z)&&(Z=R.val[Z]),n.tokenize=P(U(Z),z,s.block3),n.tokenize(e,n)):V&&F(e,V)?(n.lastToken=x,s.number):q&&F(e,q)?(n.lastToken=x,s.number2):B&&F(e,B)?(n.lastToken=x,s.number3):G&&(R=F(e,G))?(Z=I[R.key],l(Z)&&(Z=R.val[Z]),n.tokenize=C(U(Z),s.string,i),n.tokenize(e,n)):D&&(R=F(e,D))?(Z=L[R.key],l(Z)&&(Z=R.val[Z]),n.tokenize=C(U(Z),s.string2,i),n.tokenize(e,n)):j&&(R=F(e,j))?(Z=A[R.key],l(Z)&&(Z=R.val[Z]),n.tokenize=C(U(Z),s.string3,i),n.tokenize(e,n)):Y&&(Y.three&&F(e,Y.three)||Y.two&&F(e,Y.two))?(n.lastToken=_,s.delimiter):X&&(X.two&&F(e,X.two)||X.one&&F(e,X.one)||X.words&&F(e,X.words))?(n.lastToken=E,s.operator):Y&&Y.one&&F(e,Y.one)?(n.lastToken=_,s.delimiter):H&&F(e,H)?(n.lastToken=v,s.atom):J&&F(e,J)?(n.lastToken=b,s.meta):K&&F(e,K)?(n.lastToken=g,s.defines):Q&&F(e,Q)?(t=e.current(),n.lastToken=y,s.keyword):W&&F(e,W)?(t=e.current(),n.lastToken=w,s.builtin):S&&F(e,S)?(n.lastToken=T,s.identifier):M&&F(e,M)?(n.lastToken=T,s.identifier2):O&&F(e,O)?(n.lastToken=T,s.identifier3):N&&F(e,N)?(n.lastToken=T,s.identifier4):$&&F(e,$)?(n.lastToken=T,s.identifier5):(e.next(),n.lastToken=k,r)};return Z.__type=R,Z},$=function(e,n,t,l){t.DEFAULT,t.basecolumn||0,l.indentUnit,n.style,n.hasIndent;var r=function(n,l){var r,i,s;return t.indentInfo=null,null==l.tokenize&&(l.tokenize=e),r=l.tokenize(n,l),i=l.lastToken,s=n.current(),r};return r.__type=G,r},V=function(e,n){return e.DEFAULT,e.basecolumn||0,n.indentUnit,function(){return CodeMirror.Pass}},q={VERSION:e,parseGrammar:function(e,n){return e.type&&"markup-like"==e.type?q.parseMarkupLikeGrammar(e,n||c):q.parseProgrammingLikeGrammar(e,n||f)},parseMarkupLikeGrammar:function(){return null},parseProgrammingLikeGrammar:function(e,n){var t,l,r,i,s,u;if(e.__parsed)return e;if(e=m(e,n),s=e.RegExpID||null,e.RegExpID=null,delete e.RegExpID,u=e.RegExpGroups||{},e.RegExpGroups=null,delete e.RegExpGroups,e.comments){if(t=[],e.comments.line)for(l=a(e.comments.line),r=0,i=l.length;i>r;r++)t.push([l[r],null]);e.comments.block&&(l=a(e.comments.block),t.push([l[0],l[1]?l[1]:l[0]])),e.comments=t.length?O(t,s):{start:null,end:null}}else e.comments={start:null,end:null};e.blocks=e.blocks?O(e.blocks,s):{start:null,end:null},e.blocks2=e.blocks2?O(e.blocks2,s):{start:null,end:null},e.blocks3=e.blocks3?O(e.blocks3,s):{start:null,end:null},e.strings=e.strings?O(e.strings,s):{start:null,end:null},e.strings2=e.strings2?O(e.strings2,s):{start:null,end:null},e.strings3=e.strings3?O(e.strings3,s):{start:null,end:null},e.identifiers=e.identifiers?M(e.identifiers,s,u.identifiers):null,e.identifiers2=e.identifiers2?M(e.identifiers2,s,u.identifiers2):null,e.identifiers3=e.identifiers3?M(e.identifiers3,s,u.identifiers3):null,e.identifiers4=e.identifiers4?M(e.identifiers4,s,u.identifiers4):null,e.identifiers5=e.identifiers5?M(e.identifiers5,s,u.identifiers5):null,e.numbers=e.numbers?M(e.numbers,s,u.numbers):null,e.numbers2=e.numbers2?M(e.numbers2,s,u.numbers2):null,e.numbers3=e.numbers3?M(e.numbers3,s,u.numbers3):null,e.atoms=e.atoms?M(e.atoms,s,u.atoms):null,e.meta=e.meta?M(e.meta,s,u.meta):null,e.defines=e.defines?M(e.defines,s,u.defines):null,e.keywords=e.keywords?M(e.keywords,s,u.keywords):null,e.builtins=e.builtins?M(e.builtins,s,u.builtins):null,e.operators||(e.operators={one:null,two:null,words:null}),e.operators.one=e.operators.one?M(e.operators.one,s,u.operators&&u.operators.one):null,e.operators.two=e.operators.two?M(e.operators.two,s,u.operators&&u.operators.two):null,e.operators.words=e.operators.words?M(e.operators.words,s,u.operators&&u.operators.words):null,e.delimiters||(e.delimiters={one:null,two:null,three:null}),e.delimiters.one=e.delimiters.one?M(e.delimiters.one,s,u.delimiters&&u.delimiters.one):null,e.delimiters.two=e.delimiters.two?M(e.delimiters.two,s,u.delimiters&&u.delimiters.two):null,e.delimiters.three=e.delimiters.three?M(e.delimiters.three,s,u.delimiters&&u.delimiters.three):null;var d=!1;if(e.indent){if(e.indent["block-level"]||(e.indent["block-level"]={keywords:null,delims:null}),e.indent["statement-level"]||(e.indent["statement-level"]={delims:null}),e.indent["block-level"].keywords){tmp=a(e.indent["block-level"].keywords);var f={};for(r=0,i=tmp.length;i>r;r++)f[tmp[r]]=!0;e.indent["block-level"].keywords=f,d=!0}else e.indent["block-level"].keywords={};if(e.indent["block-level"].delims){for(tmp=a(e.indent["block-level"].delims),start=[],end=[],o(tmp)&&!o(tmp[0])&&(tmp=[tmp]),r=0,i=tmp.length;i>r;r++)t=A(tmp[r][0],s),l=tmp[r][1]?A(tmp[r][1],s):t,start.push(t),end.push(l);e.indent["block-level"].delims={start:start,end:end},d=!0}else e.indent["block-level"].delims={start:null,end:null};e.indent["statement-level"].delims?(e.indent["statement-level"].delims=a(e.indent["statement-level"].delims),d=!0):e.indent["statement-level"].delims=[]}else e.indent=null;return e.hasIndent=d,e.__parsed=!0,e},getMode:function(e,n,t){e=q.parseGrammar(e,n),console.log(e);var l={DEFAULT:t||null};return function(n,t){var r=N(e,l,n,t),i=$(r,e,l,n,t),s=V(l,n,t);return parser={startState:function(e){return l.basecolumn=e,{tokenize:null,lastToken:k}},token:i,indent:s}}}};"undefined"!=typeof module&&module.exports?module.exports=q:"undefined"!=typeof exports?exports=q:this.CodeMirrorGrammar=q}).call(this);